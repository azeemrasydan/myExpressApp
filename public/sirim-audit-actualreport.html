<!doctype html>
<html lang="en">

<head>
    <!--
    /   Multipurpose: Free Template by FreeHTML5.co
    /   Author: https://freehtml5.co
    /   Facebook: https://facebook.com/fh5co
    /   Twitter: https://twitter.com/fh5co
    -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Document title -->
    <title>PLUS 5S</title>
    <!-- Stylesheets & Fonts -->
    <!-- Google Fonts -->

</head>

<!-- Normalize or reset CSS with your favorite library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css">

<!-- Load paper.css for happy printing -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/paper-css/0.4.1/paper.css">

<!-- Set page size here: A5, A4 or A3 -->
<!-- Set also "landscape" if you need -->
<style>
    @page {
        size: A4
    }

    * {
        -webkit-print-color-adjust: exact !important;
        /*Chrome, Safari */
        color-adjust: exact !important;
        /*Firefox*/
    }

    .element {
        transform: rotate(90deg);
    }
</style>

<body class="A4" id="main-body">

    <section class="sheet padding-10mm" id="sirim-report-template" style="display:none">

        <!-- Write HTML just like a web page -->
        <article id="articleTemplate">
            <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;background:white;'
                id="tajukPenemuan">
                <strong><span style='font-size:21px;font-family:"Times",serif;color:white;background:black;'
                        class="tajukPenemuan">PENEMUAN
                        KETIDAKPATUHAN/PEMERHATIAN</span></strong>
            </p>
            <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'><strong><span
                        style="font-size:19px;">&nbsp;</span></strong></p>
            <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'><strong>&nbsp;</strong></p>
            <div align="center" style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'>
                <table style="width: 5.2e+2pt;border-collapse:collapse;border:none;">
                    <tbody>
                        <tr>
                            <td
                                style="width:258.0pt;border:solid windowtext 1.0pt;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:20.7pt;">
                                <p
                                    style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;'>
                                    <strong><span style="font-size:19px;">Sebelum<span
                                                style="color:black;">&nbsp;</span></span></strong><strong><span
                                            style="font-size:19px;color:black;">&nbsp;-&nbsp;</span></strong><strong><span
                                            style="font-size:27px;font-family:Wingdings;color:red;">&ucirc;</span></strong>
                                </p>
                            </td>
                            <td
                                style="width:264.75pt;border:solid windowtext 1.0pt;border-left:  none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:20.7pt;">
                                <p
                                    style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;margin-left:14.85pt;text-align:center;text-indent:-26.35pt;'>
                                    <strong><span
                                            style="font-size:19px;color:black;">Selepas</span></strong><strong><span
                                            style="font-size:19px;color:black;">&nbsp;-&nbsp;</span></strong><strong><span
                                            style='font-size:27px;font-family:  "Wingdings 2";color:green;'>P</span></strong>
                                </p>
                            </td>
                        </tr>
                        <tr>
                            <td
                                style="width: 258pt;border-right: 1pt solid windowtext;border-bottom: 1pt solid windowtext;border-left: 1pt solid windowtext;border-image: initial;border-top: none;padding: 0in 5.4pt;height: 129.75pt;vertical-align: top;">
                                <p
                                    style='margin:0.01in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;'>
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b6/Image_created_with_a_mobile_phone.png"
                                        style="text-align: left; height: 100.7pt;" alt="image"
                                        class="first-finding-image1">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b6/Image_created_with_a_mobile_phone.png"
                                        style="text-align: left;height: 100.7pt;display:none;" alt="image"
                                        class="second-finding-image1">
                                </p>
                            </td>
                            <td
                                style="width: 264.75pt;border-top: none;border-left: none;border-bottom: 1pt solid windowtext;border-right: 1pt solid windowtext;padding: 0in 5.4pt;height: 129.75pt;vertical-align: top;">
                                <p
                                    style='margin:0.01in;font-size:16px;font-family:"Times New Roman",serif;margin-left:11.05pt;text-align:center;text-indent:-22.55pt;'>
                                    <img src="http://www.allwhitebackground.com/images/2/2270.jpg"
                                        style="text-align: left;  height: 125.7pt;" alt="image"
                                        class="correction-finding-image1">
                                </p>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2"
                                style="width: 522.75pt;border-right: 1pt solid windowtext;border-bottom: 1pt solid windowtext;border-left: 1pt solid windowtext;border-image: initial;border-top: none;padding: 0in 5.4pt;height: 39.75pt;vertical-align: top;">
                                <p
                                    style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;'>
                                    <em><u class="findingDetail1">A01-2.10</u></em>
                                </p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;'
                                    class="finding-description1">
                                    Label yang dipamerkan tidak sama dengan barangan yang di simpan di rak penyimpanan
                                </p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;'
                                    class="EIS-location1">
                                    (Stor Bahan Kimia)</p>
                                <p
                                    style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;'>
                                    &nbsp;</p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'><u><span
                                            style="color:black;">PIC</span></u><span style="color:black;">: &nbsp;
                                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'><span
                                        style="color:black;" class="pic-detail1">Premis no 1</span></p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'>
                                    <strong><u><span style="color:red;">TINDAKAN PEMBETULAN</span></u></strong><span
                                        style="color:black;">:&nbsp;</span>
                                </p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'><span
                                        style="color:black;" class="correction-description1">Pembetulan perlu
                                        dilakukan</span></p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'><em><span
                                            style="color:black;">&nbsp;</span></em></p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p><br></p>
            <div align="center" style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'>
                <table style="width: 5.2e+2pt;border-collapse:collapse;border:none; display:none" class="second-table">
                    <tbody>
                        <tr>
                            <td
                                style="width:258.0pt;border:solid windowtext 1.0pt;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:20.7pt;">
                                <p
                                    style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;'>
                                    <strong><span style="font-size:19px;">Sebelum<span
                                                style="color:black;">&nbsp;</span></span></strong><strong><span
                                            style="font-size:19px;color:black;">&nbsp;-&nbsp;</span></strong><strong><span
                                            style="font-size:27px;font-family:Wingdings;color:red;">&ucirc;</span></strong>
                                </p>
                            </td>
                            <td
                                style="width:264.75pt;border:solid windowtext 1.0pt;border-left:  none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:20.7pt;">
                                <p
                                    style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;margin-left:14.85pt;text-align:center;text-indent:-26.35pt;'>
                                    <strong><span
                                            style="font-size:19px;color:black;">Selepas</span></strong><strong><span
                                            style="font-size:19px;color:black;">&nbsp;-&nbsp;</span></strong><strong><span
                                            style='font-size:27px;font-family:  "Wingdings 2";color:green;'>P</span></strong>
                                </p>
                            </td>
                        </tr>
                        <tr>
                            <td
                                style="width: 258pt;border-right: 1pt solid windowtext;border-bottom: 1pt solid windowtext;border-left: 1pt solid windowtext;border-image: initial;border-top: none;padding: 0in 5.4pt;height: 129.75pt;vertical-align: top;">
                                <p
                                    style='margin:0.01in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;'>
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b6/Image_created_with_a_mobile_phone.png"
                                        style="text-align: left; height: 100.7pt;" alt="image"
                                        class="first-finding-image2">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b6/Image_created_with_a_mobile_phone.png"
                                        style="text-align: left;height: 100.7pt;display:none;" alt="image"
                                        class="second-finding-image2">
                                </p>
                            </td>
                            <td
                                style="width: 264.75pt;border-top: none;border-left: none;border-bottom: 1pt solid windowtext;border-right: 1pt solid windowtext;padding: 0in 5.4pt;height: 129.75pt;vertical-align: top;">
                                <p
                                    style='margin:0.01in;font-size:16px;font-family:"Times New Roman",serif;margin-left:11.05pt;text-align:center;text-indent:-22.55pt;'>
                                    <img src="http://www.allwhitebackground.com/images/2/2270.jpg"
                                        style="text-align: left; height: 125.7pt;" alt="image"
                                        class="correction-finding-image2">
                                </p>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2"
                                style="width: 522.75pt;border-right: 1pt solid windowtext;border-bottom: 1pt solid windowtext;border-left: 1pt solid windowtext;border-image: initial;border-top: none;padding: 0in 5.4pt;height: 39.75pt;vertical-align: top;">
                                <p
                                    style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;'>
                                    <em><u class="findingDetail2">A01-2.10</u></em>
                                </p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;'
                                    class="finding-description2">
                                    Label yang dipamerkan tidak sama dengan barangan yang di simpan di rak penyimpanan
                                </p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;'
                                    class="EIS-location2">
                                    (Stor Bahan Kimia)</p>
                                <p
                                    style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;'>
                                    &nbsp;</p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'><u><span
                                            style="color:black;">PIC</span></u><span style="color:black;">: &nbsp;
                                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'><span
                                        style="color:black;" class="pic-detail2">Premis no 1</span></p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'>
                                    <strong><u><span style="color:red;">TINDAKAN PEMBETULAN</span></u></strong><span
                                        style="color:black;">:&nbsp;</span>
                                </p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'><span
                                        style="color:black;" class="correction-description2">Pembetulan perlu
                                        dilakukan</span></p>
                                <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'><em><span
                                            style="color:black;">&nbsp;</span></em></p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <table style="width: 5.2e+2pt;margin-left:-.6pt;border-collapse:collapse;border:none;">
                <tbody>
                    <tr></tr>
                </tbody>
            </table>
            <p><br></p>
        </article>

    </section>

    <section class="sheet padding-10mm" id="sirim-report-amalan-baik" style="display:none">

        <!-- Write HTML just like a web page -->
        <article id="articleTemplate">
            <p
                style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;text-align:center;background:white;'>
                <strong><span style='font-size:21px;font-family:"Times",serif;color:white;background:black;'>GAMBAR
                        AMALAN TERBAIK</span></strong>
            </p>
            <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'><strong>&nbsp; &nbsp; &nbsp;
                    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</strong></p>
            <p style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'><strong>&nbsp;</strong></p>
            <div align="center" style='margin:0in;font-size:16px;font-family:"Times New Roman",serif;'>
                <table style="border-collapse:collapse;border:none;">
                    <tbody>
                        <tr>
                            <td
                                style="width: 238.25pt;border: 1pt solid windowtext;padding: 0in 5.4pt;height: 6.5pt;vertical-align: top;">
                                <p style='margin:0.01in;font-size:16px;font-family:"Times New Roman",serif;'>
                                    <strong>&nbsp;<img
                                            src="https://5saudit.azurewebsites.net/assets/5SImage/5S-IA-2020-PKA(S)-SAIPOL-1606791667801[1].jpg"
                                            style="width: 228pt;" alt="image"></strong>
                                </p>
                            </td>
                            <td
                                style="width: 277.15pt;border-top: 1pt solid windowtext;border-right: 1pt solid windowtext;border-bottom: 1pt solid windowtext;border-image: initial;border-left: none;padding: 0in 5.4pt;height: 6.5pt;vertical-align: top;">
                                <p style='margin:0.01in;font-size:16px;font-family:"Times New Roman",serif;'><img
                                        src="https://5saudit.azurewebsites.net/assets/5SImage/5S-IA-2020-PKA(S)-SAIPOL-1606791667801[1].jpg"
                                        style="width: 227.8pt;" alt="image"></p>
                            </td>
                        </tr>
                        <tr>
                            <td
                                style="width: 238.25pt;border: 1pt solid windowtext;padding: 0in 5.4pt;height: 6.5pt;vertical-align: top;">
                                <p style='margin:0.01in;font-size:16px;font-family:"Times New Roman",serif;'>
                                    <strong>&nbsp;<img
                                            src="https://5saudit.azurewebsites.net/assets/5SImage/5S-IA-2020-PKA(S)-SAIPOL-1606791667801[1].jpg"
                                            style="width: 228pt;" alt="image"></strong>
                                </p>
                            </td>
                            <td
                                style="width: 277.15pt;border-top: 1pt solid windowtext;border-right: 1pt solid windowtext;border-bottom: 1pt solid windowtext;border-image: initial;border-left: none;padding: 0in 5.4pt;height: 6.5pt;vertical-align: top;">
                                <p style='margin:0.01in;font-size:16px;font-family:"Times New Roman",serif;'><img
                                        src="https://5saudit.azurewebsites.net/assets/5SImage/5S-IA-2020-PKA(S)-SAIPOL-1606791667801[1].jpg"
                                        style="width: 227.8pt;" alt="image"></p>
                            </td>
                        </tr>

                    </tbody>
                </table>
            </div>
        </article>

    </section>




    <script src="assets/js/jquery-3.3.1.js"></script>
    <!--Plugins-->
    <script src="assets/js/bootstrap.bundle.js"></script>
    <script src="assets/js/loaders.css.js"></script>
    <script src="assets/js/aos.js"></script>
    <script src="assets/js/swiper.min.js"></script>
    <script src="assets/js/lightgallery-all.min.js"></script>
    <!--Template Script-->
    <script src="assets/js/main.js"></script>


    <script>

        var unixnamefilestring;
        var uniqueauditfilename;

        unixnamefilestring = Math.round(Math.floor(Date.now() / 1000) / 600) + 1;
        uniqueauditfilename = "https://prod-20.southeastasia.logic.azure.com:443/workflows/124802c63af947828cf8d333bf4b178f/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=o4ZL_rH29N2XCAzbt9egQ2EYRCuIGeOMu7ZMLsjuhVM";
        uniquefasilitifilename = "https://prod-18.southeastasia.logic.azure.com:443/workflows/415a89ff009a404aa9a0d7f42da61225/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=mIklpr3bdUd783c57Bc68P2pTG81QGzU9Z5MfFSULHI";
        uniquelocdetailfilename = "https://prod-13.southeastasia.logic.azure.com:443/workflows/94dad5065fd3461b9857b6c5bdc8c2e8/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=ATcM8NLnGC_zUIXm-GtL6RhoxB89l-AxOtQ4AFoh_n8";
        uniquepremisedetailfilename = "https://prod-01.southeastasia.logic.azure.com:443/workflows/1863c38779124a0d8ecfdca9bb1245ee/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=lD6gt0bL6NSdvA_C4SSkMT4FNTFzJN9H06DD6zvnIuM";
        unique50specificfilename = "https://prod-17.southeastasia.logic.azure.com:443/workflows/b34126764f754993b9cbea4cc2299390/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=oLyOfFVjGbDLhWwTgGUUwbkVRyE7kQFLYf6yYmSf-4w";
        uniquegambarpenemuanfilename = "https://prod-27.southeastasia.logic.azure.com:443/workflows/15e537089bca408a8a73464032881008/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=qfsYlP-6wfLAiBBycyFg9DtpW31TD4Mz-8ZZkJYxhDA";


        //console.log(uniqueauditfilename);


        var alljsondata = [];
        var locationauditee;
        var id5s;


        (function () {
            loadDoc(getParameterByName("location"));

        })();

        function getParameterByName(name, url = window.location.href) {
            name = name.replace(/[\[\]]/g, '\\$&');
            var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, ' '));
        }



        function loadDoc(inputID) {



            var xhttp = new XMLHttpRequest();
            var myObj;
            var auditeeID = inputID;
            console.log(auditeeID)
            locationauditee = auditeeID.split("-")[0];
            id5S = auditeeID.split("-")[1];
            alljsondata = [];

            // Request to get multiple files using XMLHTTP request

            var index = [uniqueauditfilename, uniquefasilitifilename, uniquelocdetailfilename, uniquepremisedetailfilename, unique50specificfilename, uniquegambarpenemuanfilename];

            var data;


            for (var i = 0; i < index.length; i++) {

                var url = index[i];

                let request = new XMLHttpRequest();
                request.open("POST", url);
                request.setRequestHeader("Content-Type", "application/json");
                request.onreadystatechange = function () {
                    if (request.readyState === XMLHttpRequest.DONE && request.status === 200) {
                        data = JSON.parse(request.responseText);

                        if (alljsondata.length < 6) {
                            alljsondata.push(data);

                            if (alljsondata.filter(Boolean).length == 6) {
                                jsonFunctionReturn(alljsondata);
                            }

                        }

                    }

                    if (request.status === 502 && (i == 1 || i == 2)) {
                        alert("System error, please try again");
                        document.getElementById("maindisplay").innerHTML;
                    }


                }
                if (i == 0 || i == 3 || i == 5) {
                    var dataaudit = JSON.stringify({ "try": auditeeID });
                    //console.log(dataaudit);
                    request.send(dataaudit);
                }
                else {
                    request.send();
                }
            }



        }


        var auditfilejson;
        var fasiliti5sjson;
        var locationdetailjson;
        var premisedetailjson;
        var specificdetailsjson;
        var shareablelinkjson;
        var EvidenceImageTrue;

        var locationIDprompt;
        var specareaIDprompt;
        var locat;

        var listfinding = "";
        var onetimecall = true;



        function jsonFunctionReturn(myObj) {
            listfinding = "";
            auditfilejson = {};
            var todisplayarray = [];
            // Assign each array from myObj retrieved from XMLHTTP request to the correct category of JSON
            myObj.forEach(function (elementsall) {

                try {
                    if (elementsall[0].Evidence_x0020_Link_x0020_1 != undefined) { auditfilejson = elementsall; }
                    if (elementsall[0].BILIK_x0020_FASILITI != undefined) { fasiliti5sjson = elementsall; }
                    if (elementsall[0].Overall != undefined) { locationdetailjson = elementsall; }
                    if (elementsall[0].Lot_x0020_No_x002e_ != undefined) { premisedetailjson = elementsall; }
                    if (elementsall[0].Specific_x0020_Details != undefined) { specificdetailsjson = elementsall; }
                    if (elementsall[0].ShareAbleLink != undefined) { shareablelinkjson = elementsall; }
                }
                catch (err) {
                    alert("Sila masukkan no id yang sah");

                }
            });
            //console.log(specificdetailsjson);

            //console.log(specareaIDprompt);


            locationIDprompt = getParameterByName("location");

            //Filter finding according to ID prompt no
            todisplayarray = auditfilejson.filter(function (item) {

                locat = lookupProfile(locationdetailjson, "Abbreviation", locationIDprompt, "Location");

                if (item.Location == locat) {

                    return true;
                }


            });

            //console.log(todisplayarray);
            var inc;
            //console.log(todisplayarray.length);
            // To display HTML files from ID requested


            var tiadapenemuan;
            if (todisplayarray.length == 0) {

                tiadapenemuan = true;

            }

            todisplayarray = todisplayarray.filter(function (item) {

                if (item.Omitted == undefined && item.FindingType != "BP") { return true; }



            })
            console.log(todisplayarray);

            var penemuandalamproses;
            if (todisplayarray.length == 0) {

                penemuandalamproses = true;

            }

            var incPage = 1;
            var isOddInc;
            var domArray = [];
            var domElement = [];
            var elmnt = document.getElementById("sirim-report-template")

            for (inc = 0; inc < todisplayarray.length; inc++) {








                retrievepremisedetail = [];
                //i += i + 1;
                //console.log(i);

                var checkwhethercontractor = fasiliti5sjson.filter(function (elements) {

                    return elements.OData__x0035_S_x0020_ID == todisplayarray[inc].Area5SID

                });

                if (checkwhethercontractor.length > 0) {

                    var areatitle = lookupProfile(fasiliti5sjson, "OData__x0035_S_x0020_ID", todisplayarray[inc].Area5SID, "Title");
                    var areaowner = "PLUS Bhd";
                    var premiseno = todisplayarray[inc].Area5SID
                    console.log(areatitle);
                } else {

                    var retrievepremisedetail = premisedetailjson.filter(function (elements) {
                        //console.log(elements.Location);

                        return elements.OData__x0035_S_x0020_ID == todisplayarray[inc].Area5SID && elements.Location == todisplayarray[inc].Location;

                    });
                    //console.log(retrievepremisedetail);
                    var areatitle = retrievepremisedetail[0].Location_x0020_Name;
                    var areaowner = retrievepremisedetail[0].Person_x0020_In_x0020_Charge;
                    var premiseno = retrievepremisedetail[0].OData__x0035_S_x0020_ID;

                    if (premiseno == undefined) {
                        premiseno = "-";
                    }
                }

                var ftpFileLink1 = undefined;
                var ftpFileLink2 = undefined;

                var refno = todisplayarray[inc].Title;

                var ftpfilelink = "https://5s.plus.com.my/assets/external5SImage/" + todisplayarray[inc].Title + "-1.jpg";
                var htmlImage = "<img src=\"" + ftpfilelink + "\" onerror=\"this.onerror=null; this.src='" + ftpfilelink + "'\">";

                if (todisplayarray[inc].Evidence1 > 1) {

                    var ftpFileLink1 = "https://5s.plus.com.my/assets/external5SImage/" + todisplayarray[inc].Title + "-2.jpg";
                    htmlImage = htmlImage + "<img src=\"" + ftpFileLink1 + "\" onerror=\"this.onerror=null; this.src='" + ftpFileLink1 + "'\">";
                    var ftpFileLink2 = "https://5s.plus.com.my/assets/external5SImage/" + todisplayarray[inc].Title + "-3.jpg";

                    if (todisplayarray[inc].Evidence1 == 3) { htmlImage = htmlImage + "<img src=\"" + ftpFileLink2 + "\" onerror=\"this.onerror=null; this.src='" + ftpFileLink2 + "'\">"; }

                }

                var ftpCorrectionFileLink = "https://5s.plus.com.my/assets/external5SImage/" + todisplayarray[inc].Title + "-C-" + todisplayarray[inc].CASubmission + ".jpg";



                //imageExists(evidenceimage, function(exists) {console.log('RESULT: url=' + evidenceimage + ', exists=' + exists);});


                /*if(evidenceimage == undefined){
                    var evidenceimage = "https://thumbs.dreamstime.com/b/no-image-available-icon-flat-vector-no-image-available-icon-flat-vector-illustration-132482930.jpg"
                }*/

                var kategorikesalahan = todisplayarray[inc].FindingType;
                var checkpoint50 = todisplayarray[inc].OData__x0035_0Checkpoint;
                var tajukkesalahan = todisplayarray[inc].FindingTitle;
                var tindpembetulan = todisplayarray[inc].CADescription;

                switch (kategorikesalahan) {
                    case "OB":
                        kategorikesalahan = "Observation / Penemuan";
                        break;
                    case "NC":
                        kategorikesalahan = "Non-Conformance / Ketidakpatuhan"
                        break;
                    case "BP":
                        kategorikesalahan = "Amalan Terbaik"
                        break;
                    default:
                        kategorikesalahan = "-"

                }


                if (todisplayarray[inc].FindingRemarks != undefined) {
                    var keterangankesalahan = todisplayarray[inc].FindingRemarks;
                } else { keterangankesalahan = "-" }

                //console.log(areatitle + " :" + refno + " - " + evidenceimage + " - " + kategorikesalahan + " - " + checkpoint50 + " - " + tajukkesalahan + " - " + keterangankesalahan);

                listfinding += " <div class=\"card\">\n<h2>" + areatitle + "</h2>\n<p>Dikendali oleh " + areaowner + "</p>\n<p>No Rujukan: " + refno + "</p>\n<p>ID Kawasan: " + premiseno + "</p>\n" + htmlImage + "\n<div>\n<p><b>Klasifikasi penemuan audit: </b>" + kategorikesalahan + "</p>\n<p><b>Klausa 5S: </b>" + checkpoint50 + ": " + tajukkesalahan + "</p>\n<p><b>Keterangan</b></p>\n<p>" + keterangankesalahan;



                isOddInc = inc % 2;
                if (isOddInc) {
                    incPage = (inc + 1) / 2;
                    var loop = inc + 1;
                    document.getElementById("A4-" + incPage).getElementsByClassName("second-table")[0].style.display = "";
                    document.getElementById("A4-" + incPage).getElementsByClassName("findingDetail2")[0].innerText = "A" + loop + "-" + checkpoint50.replace("-", ".");
                    document.getElementById("A4-" + incPage).getElementsByClassName("EIS-location2")[0].innerText = "(" + toTitleCase(areatitle) + " => Premis no " + premiseno + ")";
                    document.getElementById("A4-" + incPage).getElementsByClassName("finding-description2")[0].innerText = keterangankesalahan;
                    document.getElementById("A4-" + incPage).getElementsByClassName("pic-detail2")[0].innerText = toTitleCase(areatitle) + " dikendali oleh " + toTitleCase(areaowner);
                    document.getElementById("A4-" + incPage).getElementsByClassName("correction-description2")[0].innerText = tindpembetulan;

                    firstFindingImage2 = document.getElementById("A4-" + incPage).getElementsByClassName("first-finding-image2")[0];
                    firstFindingImage2.src = ftpfilelink;

                    correctionFindingImage2 = document.getElementById("A4-" + incPage).getElementsByClassName("correction-finding-image2")[0];
                    correctionFindingImage2.src = ftpCorrectionFileLink;

                    correctionFindingImage2.onload = function () {

                        if (this.clientHeight > this.clientWidth) {
                            this.clientHeight = 264.75;
                            this.style.transform = "rotate(90deg)";

                        } else {

                            this.clientWidth = 240.75;;
                        }

                    };
                  
                    if (ftpFileLink1 != undefined) {

                        document.getElementById("A4-" + incPage).getElementsByClassName("second-finding-image2")[0].src = ftpFileLink1;
                        document.getElementById("A4-" + incPage).getElementsByClassName("second-finding-image2")[0].style.display = "";
                    } else {
                        resizeImage(firstFindingImage2, 300);
                    }

                } else {
                    incPage = (inc + 2) / 2;
                    domArray[incPage] = elmnt.cloneNode(true);
                    domArray[incPage].style.display = "";
                    domArray[incPage].id = "A4-" + incPage;
                    document.getElementById("main-body").appendChild(domArray[incPage]);

                    var loop = inc + 1;
                    document.getElementById("A4-" + incPage).getElementsByClassName("findingDetail1")[0].innerText = "A" + loop + "-" + checkpoint50.replace("-", ".");
                    document.getElementById("A4-" + incPage).getElementsByClassName("EIS-location1")[0].innerText = "(" + toTitleCase(areatitle) + " => Premis no " + premiseno + ")";
                    document.getElementById("A4-" + incPage).getElementsByClassName("finding-description1")[0].innerText = keterangankesalahan;
                    document.getElementById("A4-" + incPage).getElementsByClassName("pic-detail1")[0].innerText = toTitleCase(areatitle) + " dikendali oleh " + toTitleCase(areaowner);
                    document.getElementById("A4-" + incPage).getElementsByClassName("correction-description1")[0].innerText = tindpembetulan;

                    firstFindingImage1 = document.getElementById("A4-" + incPage).getElementsByClassName("first-finding-image1")[0];
                    firstFindingImage1.src = ftpfilelink;

                    correctionFindingImage1 = document.getElementById("A4-" + incPage).getElementsByClassName("correction-finding-image1")[0];
                    correctionFindingImage1.src = ftpCorrectionFileLink;
                    correctionFindingImage1.onload = function () {

                        if (this.clientHeight > this.clientWidth) {
                            this.clientHeight = 264.75;
                            this.style.transform = "rotate(90deg)";

                        } else {

                            this.clientWidth = 264.75;
                        }

                    };


                    if (ftpFileLink1 != undefined) {
                        document.getElementById("A4-" + incPage).getElementsByClassName("second-finding-image1")[0].src = ftpFileLink1;
                        document.getElementById("A4-" + incPage).getElementsByClassName("second-finding-image1")[0].style.display = "";
                    } else {
                        resizeImage(firstFindingImage1, 300);
                    }
                }



                console.log(incPage);


                var elmnt = document.getElementById("sirim-report-template");
                //console.log(elmnt);
                //console.log(elmnt.firstChild);
                console.log(elmnt.style.display)






                if (inc > 1) {
                    document.getElementById("A4-" + incPage).getElementsByClassName("tajukPenemuan")[0].innerText = "";

                }



            };
            document.getElementById("maindisplay").innerHTML = listfinding;
            if (tiadapenemuan) {
                document.getElementById("maindisplay").innerHTML = "<h2 style =\"text-align: center\">Tahniah, tiada penemuan di tempat anda!</h2>"
            } else if (penemuandalamproses) {

                document.getElementById("maindisplay").innerHTML = "<h2 style =\"text-align: center\">Semua maklumbalas anda telah dihantar dan sedang di dalam proses!</h2>"
            }

            console.log(listfinding);

        }


        function lookupProfile(myObj, propertytolookup, valtolookup, lookedupprop) {

            for (var i = 0; i < myObj.length; i++) {

                if (myObj[i][propertytolookup] === valtolookup) {
                    if (myObj[i].hasOwnProperty(lookedupprop) === true) {
                        return myObj[i][lookedupprop];
                    }

                    else {
                        return undefined;
                    }

                }

            }
        }

        function toTitleCase(str) {
            return str.replace(
                /\w\S*/g,
                function (txt) {
                    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
                }
            );
        }

        function rotateImage(img, imgWidth) {

            console.log(img.Height > img.Width);

            if (img.Height > img.Width) {
                img.Height = imgWidth * 3;
                img.style.transform = "rotate(90deg)";

            } else {

                thisWidth = imgWidth;
            }



        }

        function resizeImage(img, imgHeight) {


            img.Height = imgHeight;
        }


    </script>



</body>

</html>